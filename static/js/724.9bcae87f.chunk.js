"use strict";(self.webpackChunkcomponents_demo=self.webpackChunkcomponents_demo||[]).push([[724],{19724:(e,s,l)=>{l.r(s),l.d(s,{default:()=>V});var t=l(89379),i=l(53986),n=l(68952),o=l(3427),r=l(70494),d=l(61693),a=l(8354),c=l(47419),u=l(11645),h=l(98080),v=l(1118),p=l(15492),x=l(14524),A=l(61966),y=l(75337),f=l(65043),j=l(70579);const g=["expressList"],m=["key","name"],{TextArea:S}=n.A,T={IS_NOT_EMPTY:"\u4e0d\u4e3a\u7a7a",IS_EMPTY:"\u4e3a\u7a7a",EQUALS:"==",NOT_EQUALS:"!=",IN:"IN",NOT_IN:"NOT_IN",GREATER_THAN:">",GREATER_THAN_OR_EQUAL_TO:">=",LESS_THAN:"<",LESS_THAN_OR_EQUAL_TO:"<="},k=e=>{const{keyPath:s,value:l,specialAssertConfigs:k=[],onConfirm:E}=e,[b]=o.A.useForm(),[w,C]=(0,f.useState)(!1),[_,N]=(0,f.useState)(),[L,O]=(0,f.useState)(null);(0,f.useEffect)(()=>{if(w){var e;const t=null===k||void 0===k?void 0:k.find(e=>(null===e||void 0===e?void 0:e.keyPath)===s);b.setFieldsValue({keyPath:s,value:l,expressList:null===t||void 0===t||!t.expressList||(null===t||void 0===t||null===(e=t.expressList)||void 0===e?void 0:e.length)<1?[{}]:null===t||void 0===t?void 0:t.expressList}),I()}},[w]);const I=()=>{const e=b.getFieldsValue();N(e);(e.expressList||[]).forEach((e,s)=>{null!==e&&void 0!==e&&e.expectValue||b.setFields([{name:["expressList",s,"parseFunction"],errors:[]}]),null!==e&&void 0!==e&&e.parseFunction||b.setFields([{name:["expressList",s,"expectValue"],errors:[]}])})};return(0,j.jsxs)("div",{style:{display:"inline-block"},onClick:e=>{e.stopPropagation()},children:[(0,j.jsx)(r.A,{title:"\u914d\u7f6e\u7279\u6b8a\u6821\u9a8c",children:(0,j.jsx)("a",{style:{cursor:"pointer"},onClick:e=>C(!0),children:(0,j.jsx)(x.A,{})})}),(0,j.jsx)(d.A,{title:"\u914d\u7f6e\u7279\u6b8a\u6821\u9a8c",width:650,style:{},open:w,onCancel:()=>C(!1),onOk:()=>{b.submit()},children:(0,j.jsxs)(o.A,{form:b,onFinish:e=>{const{expressList:s}=e,l=(0,i.A)(e,g),n=(0,t.A)((0,t.A)({},l),{},{expressList:null===s||void 0===s?void 0:s.filter(e=>["IS_NOT_EMPTY","IS_EMPTY"].includes(null===e||void 0===e?void 0:e.operator)?null===e||void 0===e?void 0:e.parseFunction:(null===e||void 0===e?void 0:e.parseFunction)&&(null===e||void 0===e?void 0:e.expectValue))});E(n),C(!1)},children:[(0,j.jsx)(o.A.Item,{label:"\u5b57\u6bb5\u8def\u5f84",name:"keyPath",children:(0,j.jsx)(n.A,{disabled:!0})}),(0,j.jsx)(o.A.Item,{label:"\u6570\u636e\u8be6\u60c5",name:"value",children:(0,j.jsx)(S,{placeholder:"\u8f93\u5165",disabled:!0})}),(0,j.jsx)(a.A,{}),(0,j.jsx)(o.A.List,{name:"expressList",children:(e,s)=>{let{add:l,remove:r}=s;return(0,j.jsxs)(j.Fragment,{children:[e.map(e=>{var s,l,d,p,x,y,f,g,k,E,b,w,C,N,P,M;let{key:F,name:V}=e,R=(0,i.A)(e,m);return(0,j.jsxs)(c.A,{gutter:[8,6],children:[(0,j.jsx)(u.A,{span:24,children:(0,j.jsx)(o.A.Item,(0,t.A)((0,t.A)({},R),{},{label:"\u89e3\u6790\u51fd\u6570",name:[V,"parseFunction"],rules:[{required:!!["IS_NOT_EMPTY","IS_EMPTY"].includes(null===_||void 0===_||null===(s=_.expressList)||void 0===s||null===(l=s[V])||void 0===l?void 0:l.operator)||(null===_||void 0===_||null===(d=_.expressList)||void 0===d||null===(p=d[V])||void 0===p?void 0:p.expectValue),message:"\u8bf7\u8f93\u5165"}],required:!1,children:(0,j.jsx)(S,{rows:3,placeholder:"\u8f93\u5165",onChange:()=>{L&&clearTimeout(L);const e=setTimeout(()=>{I()},300);O(e)}})}))}),(0,j.jsx)(u.A,{span:8,children:(0,j.jsx)(o.A.Item,(0,t.A)((0,t.A)({},R),{},{label:"\u6821\u9a8c\u89c4\u5219",name:[V,"operator"],initialValue:"EQUALS",children:(0,j.jsx)(h.A,{onSelect:()=>{I()},showSearch:!0,placeholder:"\u8bf7\u9009\u62e9",options:Object.entries(T).map(e=>({value:e[0],label:e[1]}))})}))}),(0,j.jsx)(u.A,{span:15,children:(0,j.jsx)(o.A.Item,(0,t.A)((0,t.A)({},R),{},{name:[V,"expectValue"],rules:[{required:!["IS_NOT_EMPTY","IS_EMPTY"].includes(null===_||void 0===_||null===(x=_.expressList)||void 0===x||null===(y=x[V])||void 0===y?void 0:y.operator)&&(null===_||void 0===_||null===(f=_.expressList)||void 0===f||null===(g=f[V])||void 0===g?void 0:g.parseFunction),message:"\u8bf7\u8f93\u5165"}],children:["GREATER_THAN","GREATER_THAN_OR_EQUAL_TO","LESS_THAN","LESS_THAN_OR_EQUAL_TO"].includes(null===_||void 0===_||null===(k=_.expressList)||void 0===k||null===(E=k[V])||void 0===E?void 0:E.operator)?(0,j.jsx)(v.A,{style:{width:"100%"},placeholder:"\u8f93\u5165\uff08\u6570\u5b57\uff09",disabled:["IS_NOT_EMPTY","IS_EMPTY"].includes(null===_||void 0===_||null===(b=_.expressList)||void 0===b||null===(w=b[V])||void 0===w?void 0:w.operator),onChange:()=>{L&&clearTimeout(L);const e=setTimeout(()=>{I()},300);O(e)}}):(0,j.jsx)(n.A,{placeholder:["NOT_IN","IN"].includes(null===_||void 0===_||null===(C=_.expressList)||void 0===C||null===(N=C[V])||void 0===N?void 0:N.operator)?"\u591a\u4e2a\u503c\u8bf7\u7528\u82f1\u6587\u9017\u53f7\u5206\u9694":"\u8f93\u5165",disabled:["IS_NOT_EMPTY","IS_EMPTY"].includes(null===_||void 0===_||null===(P=_.expressList)||void 0===P||null===(M=P[V])||void 0===M?void 0:M.operator),onChange:()=>{L&&clearTimeout(L);const e=setTimeout(()=>{I()},300);O(e)}})}))}),(0,j.jsx)(u.A,{span:1,children:(0,j.jsx)(A.A,{style:{color:"red",marginTop:8,fontSize:16,cursor:"pointer"},onClick:()=>{r(V),I()}})}),(0,j.jsx)(a.A,{style:{marginTop:-10}})]},F)}),(0,j.jsx)(o.A.Item,{children:(0,j.jsx)(p.Ay,{style:{width:"100%"},type:"dashed",onClick:()=>{l()},block:!0,icon:(0,j.jsx)(y.A,{}),children:"\u6dfb\u52a0\u89c4\u5219"})})]})}})]})})]})};var E=l(63390),b=l(53727),w=l(67407);const C=e=>{const{value:s,onEdit:l}=e,[t,i]=(0,f.useState)(s),[o,d]=(0,f.useState)(t),[a,c]=(0,f.useState)(!1),u=(0,f.useRef)(null),[h,v]=(0,f.useState)(0),[p,x]=(0,f.useState)(0),A=()=>{const e=u.current.offsetWidth,s=e/document.documentElement.clientWidth*100;v(e),x(s)};return(0,f.useEffect)(()=>{u.current&&A()},[u.current]),(0,j.jsx)("div",{style:{display:"inline-block"},children:(0,j.jsxs)("div",{style:{display:"flex"},children:[(0,j.jsx)("div",{children:a?(0,j.jsx)(n.A.TextArea,{rows:h>300?4:1,style:{width:h>300?"26vw":h+40,resize:"both"},value:o,onChange:e=>{d(e.target.value)}}):(0,j.jsx)("span",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:4,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"24vw",lineHeight:"1.5",maxHeight:"6em"},ref:u,children:p>20?(0,j.jsx)(r.A,{placement:"topLeft",title:t,overlayStyle:{maxWidth:"30vw"},children:t}):t})}),(0,j.jsxs)("div",{style:{marginLeft:12,color:"#5478FC"},children:[a&&(0,j.jsxs)("div",{style:{display:"flex"},children:[(0,j.jsx)("div",{children:(0,j.jsx)(E.A,{onClick:()=>{i(o),l(o),c(!1)}})}),(0,j.jsx)("div",{style:{marginLeft:5},children:(0,j.jsx)(b.A,{onClick:()=>{c(!1)}})})]}),!a&&(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(w.A,{onClick:()=>{A(),c(!0)}})})]})]})})};var _=l(32513),N=l(83051);const L=(e,s,l)=>{if(!e||!s||void 0===l)return;const t=JSON.parse(JSON.stringify(e)),i=s.split(".");let n=t;for(let o=0;o<i.length-1;o++){const e=isNaN(Number(i[o]))?i[o]:Number(i[o]);if(!n[e])throw new Error("Property not found: ".concat(i[o]));n=n[e]}return n[isNaN(Number(i[i.length-1]))?i[i.length-1]:Number(i[i.length-1])]=l,t},O=e=>{try{const s=[],l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Array.isArray(e)&&e.forEach((e,i)=>{const n="".concat(t,".").concat(i);"object"===typeof e&&null!==e?l(e,n):s.push(n)}),null!==e&&"object"===typeof e&&Object.keys(e).forEach(i=>{const n=e[i],o=t?"".concat(t,".").concat(i):i;"object"===typeof n&&null!==n?l(n,o):s.push(o)})};return l(e),s}catch(s){console.error(s)}},I=e=>Array.isArray(e)?0===e.length?"[]":e.map(I):null!==e&&"object"===typeof e?Object.fromEntries(Object.entries(e).map(e=>{let[s,l]=e;return[s,I(l)]})):e,P=e=>Array.isArray(e)?e.map(e=>{const s=e.replace(/^[^.]+/,"").replace(/\.(\d+)/g,"[$1]");return"$".concat(s)}):[],M=e=>{const{data:s,rootNode:l,showAssertChecked:t=!1,showEditValue:i=!1,isAllAssert:n=!1,isAllCheckbox:o=!1,onChange:r,noShowAssert:d,showConfigSpecialVerif:a=!1}=e,[c,u]=(0,f.useState)(s),[h,v]=(0,f.useState)(),[p,x]=(0,f.useState)([]),[A,y]=(0,f.useState)([]);(0,f.useEffect)(()=>{r(c)},[c]);const[g,m]=(0,f.useState)(!0);(0,f.useEffect)(()=>{if(s){const t=I(c);if(null===t||void 0===t||delete t[l].assertKeys,null===t||void 0===t||delete t[l].specialAssertConfigs,v(t),g){var e;const i=((e,s)=>Array.isArray(e)?e.map(e=>{let l=e.replace(/^\$/,"");return l=l.replace(/\[(\d+)\]/g,".$1"),l.startsWith(".")&&(l=l.slice(1)),"".concat(s,".").concat(l)}):[])(null===(e=s[l])||void 0===e?void 0:e.assertKeys,l);x(i),y(O(t)),o&&T(!0,t)}m(!1)}},[s]);const S=(e,s,l)=>{const t=L(e,s,l);u(t)},T=(e,s)=>{if(console.log("\ud83d\ude80 ~ selectAll ~ check:",e),e){const e=O(s||h);x(e)}else x([])};(0,f.useEffect)(()=>{var e;console.log("assertKeys",p),t&&((e=p).length>0?S(c,"".concat(l,".assertKeys"),P(e)):S(c,"".concat(l,".assertKeys"),[]))},[p]);const E=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"root",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=function(e,r){var h,v,y;let f=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const g=0===o?"".concat(r):"".concat(s,".").concat(r),m=f?(0,j.jsxs)("div",{style:{display:"flex"},children:[(0,j.jsxs)("span",{children:[r,"\uff1a"]}),(0,j.jsx)("span",{children:i?(0,j.jsx)(C,{value:String(e),onEdit:e=>((e,s)=>{S(c,e,s)})(g,e)}):String(e)}),(0,j.jsx)("span",{style:{display:a?"":"none",marginLeft:5},children:(0,j.jsx)(k,{keyPath:null===(h=P([g]))||void 0===h?void 0:h[0],value:String(e),specialAssertConfigs:null!==(v=null===c||void 0===c||null===(y=c[l])||void 0===y?void 0:y.specialAssertConfigs)&&void 0!==v?v:[],onConfirm:e=>{(e=>{var s,t;const i=null!==(s=null===c||void 0===c||null===(t=c[l])||void 0===t?void 0:t.specialAssertConfigs)&&void 0!==s?s:[],n=new Map;[...i,e].forEach(e=>{n.set(e.keyPath,e)});const o=Array.from(n.values()),r=L(c,"".concat(l,".specialAssertConfigs"),o);u(r)})(e)}})}),(0,j.jsx)("span",{style:{marginLeft:5,display:t?"":"none"},children:(0,j.jsx)(_.A,{checked:null===p||void 0===p?void 0:p.includes(g),onChange:e=>{((e,s)=>{let l=[...p];e?l.push(s):l=l.filter(e=>e!==s),x(l)})(e.target.checked,g)},children:(0,j.jsx)("span",{style:{color:"red"},children:d?"":"Assert"})})})]}):(0,j.jsxs)("div",{children:[(0,j.jsx)("span",{children:r}),(0,j.jsx)("span",{style:{marginLeft:15,display:["editData"].includes(g)&&n&&t?"":"none"},children:(0,j.jsx)(_.A,{style:{visibility:n?"visibility":"hidden"},checked:(null===A||void 0===A?void 0:A.length)===(null===p||void 0===p?void 0:p.length),indeterminate:0<(null===p||void 0===p?void 0:p.length)&&(null===p||void 0===p?void 0:p.length)<(null===A||void 0===A?void 0:A.length),onChange:e=>T(e.target.checked),children:(0,j.jsx)("span",{children:"\u5168\u9009"})})})]});return{key:g,title:m,children:f?null:E(e,g,o+1)}};return Array.isArray(e)&&(null===e||void 0===e?void 0:e.length)>0?e.map((e,s)=>{const l=s;return"object"===typeof e?r(e,l):r(e,l,!0)}):null!==e&&"object"===typeof e?Object.keys(e).map(s=>{const l=e[s];return r(l,s,!(null!==l&&"object"===typeof l))}):[{key:s,title:"".concat(s,": ").concat(e)}]},b=(0,f.useMemo)(()=>E(h),[h]);return(0,j.jsx)("div",{style:{width:"100%",overflowX:"auto"},children:h&&(0,j.jsx)(N.A,{defaultExpandedKeys:A,treeData:b,virtual:!0})})},F={request:{id:"2190170000031691",paymentFactor:{productCode:"MC400401000000000028",editData:{a:12},skipPayFailedSendMsgProcess:!1,fundFlowMetadata:{}},paymentMethodTypes:["P24","P25",{bizType:"TRADE",productCode:"MC400401000000000028",internalUser:!0}]}},V=()=>{var e,s,l,t;const[i,n]=(0,f.useState)(["showAssertChecked","showEditValue","showConfigSpecialVerif"]),[o,r]=(0,f.useState)(F);return(0,j.jsx)("div",{style:{padding:15},children:(0,j.jsxs)("div",{style:{display:"flex",fontSize:12,gap:24},children:[(0,j.jsxs)("div",{style:{width:500},children:[(0,j.jsx)("h3",{children:"\u6570\u636e\u6e90"}),(0,j.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",backgroundColor:"#f5f5f5"},children:(0,j.jsx)("code",{children:JSON.stringify(null===o||void 0===o||null===(e=o.editData)||void 0===e?void 0:e.data,null,2)})}),(0,j.jsx)("h3",{children:"\u9009\u62e9\u8282\u70b9"}),(0,j.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",backgroundColor:"#f5f5f5"},children:(0,j.jsx)("code",{children:JSON.stringify(null!==(s=null===o||void 0===o||null===(l=o.editData)||void 0===l?void 0:l.assertKeys)&&void 0!==s?s:"{}",null,2)})}),(0,j.jsx)("h3",{children:"\u6821\u9a8c\u89c4\u5219"}),(0,j.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",backgroundColor:"#f5f5f5"},children:(0,j.jsx)("code",{children:JSON.stringify(null===o||void 0===o||null===(t=o.editData)||void 0===t?void 0:t.specialAssertConfigs,null,2)})})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{style:{marginBottom:20},children:(0,j.jsx)(_.A.Group,{options:[{label:"Assert",value:"showAssertChecked"},{label:"\u7f16\u8f91",value:"showEditValue"},{label:"\u914d\u7f6e",value:"showConfigSpecialVerif"}],value:i,onChange:e=>{n(e)}})}),(0,j.jsx)(M,{data:{editData:{data:o,assertKeys:["$.data.request.id","$.data.request.paymentMethodTypes[2].bizType"]}},rootNode:"editData",showAssertChecked:i.includes("showAssertChecked"),showEditValue:i.includes("showEditValue"),showConfigSpecialVerif:i.includes("showConfigSpecialVerif"),isAllAssert:!0,isAllCheckbox:!1,onChange:e=>{console.log("\ud83d\ude80 ~ DomainCase ~ vals:",e),r(e)}})]})]})})}}}]);
//# sourceMappingURL=724.9bcae87f.chunk.js.map