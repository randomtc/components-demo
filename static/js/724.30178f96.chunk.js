"use strict";(self.webpackChunkcomponents_demo=self.webpackChunkcomponents_demo||[]).push([[724],{9724:(e,l,t)=>{t.r(l),t.d(l,{default:()=>M});var s=t(5043),n=t(855),i=t(3513),o=t(3390),r=t(3727),a=t(7407),d=t(9577),c=t(3343),u=t(579);const v=e=>{const{value:l,onEdit:t}=e,[n,i]=(0,s.useState)(l),[v,p]=(0,s.useState)(n),[h,x]=(0,s.useState)(!1),y=(0,s.useRef)(null),[m,f]=(0,s.useState)(0),[A,j]=(0,s.useState)(0),S=()=>{const e=y.current.offsetWidth,l=e/document.documentElement.clientWidth*100;f(e),j(l)};return(0,s.useEffect)((()=>{y.current&&S()}),[y.current]),(0,u.jsx)("div",{style:{display:"inline-block"},children:(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsx)("div",{children:h?(0,u.jsx)(c.A.TextArea,{rows:m>300?4:1,style:{width:m>300?"26vw":m+40,resize:"both"},value:v,onChange:e=>{p(e.target.value)}}):(0,u.jsx)("span",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:4,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"24vw",lineHeight:"1.5",maxHeight:"6em"},ref:y,children:A>20?(0,u.jsx)(d.A,{placement:"topLeft",title:n,overlayStyle:{maxWidth:"30vw"},children:n}):n})}),(0,u.jsxs)("div",{style:{marginLeft:12,color:"#5478FC"},children:[h&&(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsx)("div",{children:(0,u.jsx)(o.A,{onClick:()=>{i(v),t(v),x(!1)}})}),(0,u.jsx)("div",{style:{marginLeft:5},children:(0,u.jsx)(r.A,{onClick:()=>{x(!1)}})})]}),!h&&(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(a.A,{onClick:()=>{S(),x(!0)}})})]})]})})},p=(e,l,t)=>{if(!e||!l||void 0===t)return;const s=JSON.parse(JSON.stringify(e)),n=l.split(".");let i=s;for(let o=0;o<n.length-1;o++){const e=isNaN(Number(n[o]))?n[o]:Number(n[o]);if(!i[e])throw new Error(`Property not found: ${n[o]}`);i=i[e]}return i[isNaN(Number(n[n.length-1]))?n[n.length-1]:Number(n[n.length-1])]=t,s};function h(e,l,t){try{const s=JSON.parse(JSON.stringify(e));return t.forEach((e=>{const t=s[l][e];"string"===typeof t&&(s[l][e]="null"===t?"null":"realYamlData"===e?t:(e=>{try{return JSON.parse(e),!0}catch(l){return!1}})(t)?JSON.parse(t):t)})),s}catch(s){return console.error("Failed to process fields:",s),e[l]||{}}}const x=e=>{try{const l=JSON.parse(JSON.stringify(e)),t=[],s=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Array.isArray(e)?e.forEach(((e,n)=>{const i=`${l}.${n}`;"object"===typeof e&&null!==e?s(e,i):t.push(i)})):null!==e&&"object"===typeof e&&Object.keys(e).forEach((n=>{const i=e[n],o=l?`${l}.${n}`:n;"object"===typeof i&&null!==i?s(i,o):t.push(o)}))};return s(l),t}catch(l){console.error(l)}},y=e=>Array.isArray(e)?0===e.length?"[]":e.map(y):null!==e&&"object"===typeof e?Object.fromEntries(Object.entries(e).map((e=>{let[l,t]=e;return[l,y(t)]}))):e,m=e=>e.map((e=>`$${e.replace(/^[^\.]+/,"").replace(/\.(\d+)/g,"[$1]")}`));var f=t(9748),A=t(1121),j=t(8354),S=t(7419),g=t(1645),T=t(3117),E=t(1118),N=t(5206),b=t(4524),C=t(1966),_=t(5337);const{TextArea:k}=c.A,L={IS_NOT_EMPTY:"\u4e0d\u4e3a\u7a7a",IS_EMPTY:"\u4e3a\u7a7a",EQUALS:"==",NOT_EQUALS:"!=",IN:"IN",NOT_IN:"NOT_IN",GREATER_THAN:">",GREATER_THAN_OR_EQUAL_TO:">=",LESS_THAN:"<",LESS_THAN_OR_EQUAL_TO:"<="},O=e=>{const{keyPath:l,value:t,specialAssertConfigs:n=[],onConfirm:i}=e,[o]=f.A.useForm(),[r,a]=(0,s.useState)(!1),[v,p]=(0,s.useState)(),[h,x]=(0,s.useState)(null);(0,s.useEffect)((()=>{if(r){var e;const s=null===n||void 0===n?void 0:n.find((e=>(null===e||void 0===e?void 0:e.keyPath)===l));o.setFieldsValue({keyPath:l,value:t,expressList:null===s||void 0===s||!s.expressList||(null===s||void 0===s||null===(e=s.expressList)||void 0===e?void 0:e.length)<1?[{}]:null===s||void 0===s?void 0:s.expressList}),y()}}),[r]);const y=()=>{const e=o.getFieldsValue();p(e);(e.expressList||[]).forEach(((e,l)=>{null!==e&&void 0!==e&&e.expectValue||o.setFields([{name:["expressList",l,"parseFunction"],errors:[]}]),null!==e&&void 0!==e&&e.parseFunction||o.setFields([{name:["expressList",l,"expectValue"],errors:[]}])}))};return(0,u.jsxs)("div",{style:{display:"inline-block"},onClick:e=>{e.stopPropagation()},children:[(0,u.jsx)(d.A,{title:"\u914d\u7f6e\u7279\u6b8a\u6821\u9a8c",children:(0,u.jsx)("a",{style:{cursor:"pointer"},onClick:e=>a(!0),children:(0,u.jsx)(b.A,{})})}),(0,u.jsx)(A.A,{title:"\u914d\u7f6e\u7279\u6b8a\u6821\u9a8c",width:650,style:{},open:r,onCancel:()=>a(!1),onOk:()=>{o.submit()},children:(0,u.jsxs)(f.A,{form:o,onFinish:e=>{const{expressList:l,...t}=e,s={...t,expressList:null===l||void 0===l?void 0:l.filter((e=>["IS_NOT_EMPTY","IS_EMPTY"].includes(null===e||void 0===e?void 0:e.operator)?null===e||void 0===e?void 0:e.parseFunction:(null===e||void 0===e?void 0:e.parseFunction)&&(null===e||void 0===e?void 0:e.expectValue)))};i(s),a(!1)},children:[(0,u.jsx)(f.A.Item,{label:"\u5b57\u6bb5\u8def\u5f84",name:"keyPath",children:(0,u.jsx)(c.A,{disabled:!0})}),(0,u.jsx)(f.A.Item,{label:"\u6570\u636e\u8be6\u60c5",name:"value",children:(0,u.jsx)(k,{placeholder:"\u8f93\u5165",disabled:!0})}),(0,u.jsx)(j.A,{}),(0,u.jsx)(f.A.List,{name:"expressList",children:(e,l)=>{let{add:t,remove:s}=l;return(0,u.jsxs)(u.Fragment,{children:[e.map((e=>{var l,t,n,i,o,r,a,d,p,m,A,N,b,_,O,P;let{key:I,name:w,...M}=e;return(0,u.jsxs)(S.A,{gutter:[8,6],children:[(0,u.jsx)(g.A,{span:24,children:(0,u.jsx)(f.A.Item,{...M,label:"\u89e3\u6790\u51fd\u6570",name:[w,"parseFunction"],rules:[{required:!!["IS_NOT_EMPTY","IS_EMPTY"].includes(null===v||void 0===v||null===(l=v.expressList)||void 0===l||null===(t=l[w])||void 0===t?void 0:t.operator)||(null===v||void 0===v||null===(n=v.expressList)||void 0===n||null===(i=n[w])||void 0===i?void 0:i.expectValue),message:"\u8bf7\u8f93\u5165"}],required:!1,children:(0,u.jsx)(k,{rows:3,placeholder:"\u8f93\u5165",onChange:()=>{h&&clearTimeout(h);const e=setTimeout((()=>{y()}),300);x(e)}})})}),(0,u.jsx)(g.A,{span:8,children:(0,u.jsx)(f.A.Item,{...M,label:"\u6821\u9a8c\u89c4\u5219",name:[w,"operator"],initialValue:"EQUALS",children:(0,u.jsx)(T.A,{onSelect:()=>{y()},showSearch:!0,dropdownStyle:{filter:"invert(0.85) hue-rotate(170deg)",boxShadow:"none"},placeholder:"\u8bf7\u9009\u62e9",options:Object.entries(L).map((e=>({value:e[0],label:e[1]})))})})}),(0,u.jsx)(g.A,{span:15,children:(0,u.jsx)(f.A.Item,{...M,name:[w,"expectValue"],rules:[{required:!["IS_NOT_EMPTY","IS_EMPTY"].includes(null===v||void 0===v||null===(o=v.expressList)||void 0===o||null===(r=o[w])||void 0===r?void 0:r.operator)&&(null===v||void 0===v||null===(a=v.expressList)||void 0===a||null===(d=a[w])||void 0===d?void 0:d.parseFunction),message:"\u8bf7\u8f93\u5165"}],children:["GREATER_THAN","GREATER_THAN_OR_EQUAL_TO","LESS_THAN","LESS_THAN_OR_EQUAL_TO"].includes(null===v||void 0===v||null===(p=v.expressList)||void 0===p||null===(m=p[w])||void 0===m?void 0:m.operator)?(0,u.jsx)(E.A,{style:{width:"100%"},placeholder:"\u8f93\u5165\uff08\u6570\u5b57\uff09",disabled:["IS_NOT_EMPTY","IS_EMPTY"].includes(null===v||void 0===v||null===(A=v.expressList)||void 0===A||null===(N=A[w])||void 0===N?void 0:N.operator),onChange:()=>{h&&clearTimeout(h);const e=setTimeout((()=>{y()}),300);x(e)}}):(0,u.jsx)(c.A,{placeholder:["NOT_IN","IN"].includes(null===v||void 0===v||null===(b=v.expressList)||void 0===b||null===(_=b[w])||void 0===_?void 0:_.operator)?"\u591a\u4e2a\u503c\u8bf7\u7528\u82f1\u6587\u9017\u53f7\u5206\u9694":"\u8f93\u5165",disabled:["IS_NOT_EMPTY","IS_EMPTY"].includes(null===v||void 0===v||null===(O=v.expressList)||void 0===O||null===(P=O[w])||void 0===P?void 0:P.operator),onChange:()=>{h&&clearTimeout(h);const e=setTimeout((()=>{y()}),300);x(e)}})})}),(0,u.jsx)(g.A,{span:1,children:(0,u.jsx)(C.A,{style:{color:"red",marginTop:8,fontSize:16,cursor:"pointer"},onClick:()=>{s(w),y()}})}),(0,u.jsx)(j.A,{style:{marginTop:-10}})]},I)})),(0,u.jsx)(f.A.Item,{children:(0,u.jsx)(N.Ay,{style:{width:"100%"},type:"dashed",onClick:()=>{t()},block:!0,icon:(0,u.jsx)(_.A,{}),children:"\u6dfb\u52a0\u89c4\u5219"})})]})}})]})})]})},P=["yamlData","properties","sofaContext","eventPayload","headers","realYamlData"],I=e=>{const{data:l,rootNode:t,assertChecked:o=!1,editValue:r=!1,isAllAssert:a=!1,isAllCheckbox:d=!1,onChange:c,interfaceObj:f,showNode:A,noShowAssert:j,noShowConfigSpecialVerif:S=!1,selectKey:g,selectKeyRootNode:T}=e,[E,N]=(0,s.useState)(h(l,t,P)),[b,C]=(0,s.useState)(),[_,k]=(0,s.useState)([]),[L,I]=(0,s.useState)([]);(0,s.useEffect)((()=>{c(E)}),[E]);const[w,M]=(0,s.useState)(!0);(0,s.useEffect)((()=>{if(l){var e,s,n,i,o,r;const d=h(l,t,P);var a;if(w)k(((e,l,t)=>e?e.map((e=>{let s=e.replace(/^\$/,"");return s=s.replace(/\[(\d+)\]/g,".$1"),s.startsWith(".")&&(s=s.slice(1)),`${null!==l&&void 0!==l?l:t}.${s}`})):[])(null===(a=d[t])||void 0===a?void 0:a[g||"assertKeys"],T,t));d.rootNode=d;const c=null===d||void 0===d||null===(e=d[t])||void 0===e?void 0:e.yamlData,u=null===d||void 0===d||null===(s=d[t])||void 0===s?void 0:s.properties,v=null===d||void 0===d||null===(n=d[t])||void 0===n?void 0:n.sofaContext,p=null===d||void 0===d||null===(i=d[t])||void 0===i?void 0:i.eventPayload,m=null===d||void 0===d||null===(o=d[t])||void 0===o?void 0:o.headers,j=null===d||void 0===d||null===(r=d[t])||void 0===r?void 0:r.realYamlData,S={yamlData:c,properties:u,sofaContext:v,eventPayload:p},E={yamlData:c,sofaContext:v},N={yamlData:c,headers:m},b={[A]:S[A]},_={[A]:E[A]},L={[A]:N[A]},O=()=>{const e={[t]:c||{}};let l=e;return"realYamlData"===A&&(l={[t]:j||{}}),"MSG"===f&&(l=b),"RPC"===f&&(l=A?_:e),"HTTP"===f&&(l=A?L:e),l};C(y(O())),w&&I(x(y(O()))),M(!1)}}),[l]);const Y=(e,l,t)=>{const s=l.split(".")||[];"MSG"===f&&"assertKeys"!==s[1]&&("realYamlData"===A?s.splice(1,0,"realYamlData"):s.unshift("request")),"MSG"!==f&&"assertKeys"!==s[1]&&(A?"realYamlData"===A?s.splice(1,0,"realYamlData"):s.unshift("request"):s.splice(1,0,"yamlData"));const n=null===s||void 0===s?void 0:s.join("."),i=p(e,n,t);N(i)},F=e=>{if(e){const e=x(b);k(e)}else k([])},[$,D]=(0,s.useState)(!0);(0,s.useEffect)((()=>{[$,d,b,0===(null===_||void 0===_?void 0:_.length)].every((e=>e))&&(F(!0),D(!1))}),[t,b]),(0,s.useEffect)((()=>{var e;o&&((e=_).length>0?Y(E,`${t}.assertKeys`,m(e)):Y(E,`${t}.assertKeys`,[]))}),[_]);const R=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"root",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=function(e,i){var d,c,h;let x=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const y=0===s?`${i}`:`${l}.${i}`,f=x?(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsxs)("span",{children:[i,"\uff1a"]}),(0,u.jsx)("span",{children:r?(0,u.jsx)(v,{value:String(e),onEdit:e=>((e,l)=>{Y(E,e,l)})(y,e)}):String(e)}),(0,u.jsx)("span",{style:{display:o?"":"none",margin:"0 2px"},children:(0,u.jsx)("span",{style:{display:S?"none":""},children:(0,u.jsx)(O,{keyPath:null===(d=m([y]))||void 0===d?void 0:d[0],value:String(e),specialAssertConfigs:null!==(c=null===E||void 0===E||null===(h=E[t])||void 0===h?void 0:h.specialAssertConfigs)&&void 0!==c?c:[],onConfirm:e=>{(e=>{var l,s;const n=null!==(l=null===E||void 0===E||null===(s=E[t])||void 0===s?void 0:s.specialAssertConfigs)&&void 0!==l?l:[],i=new Map;[...n,e].forEach((e=>{i.set(e.keyPath,e)}));const o=Array.from(i.values()),r=p(E,`${t}.specialAssertConfigs`,o);N(r)})(e)}})})}),(0,u.jsx)("span",{style:{marginLeft:5,display:o?"":"none"},children:(0,u.jsx)(n.A,{checked:null===_||void 0===_?void 0:_.includes(y),onChange:e=>{((e,l)=>{let t=[..._];e?t.push(l):t=t.filter((e=>e!==l)),k(t)})(e.target.checked,y)},children:(0,u.jsx)("span",{style:{color:"red"},children:j?"":"Assert"})})})]}):(0,u.jsxs)("div",{children:[(0,u.jsx)("span",{children:i}),(0,u.jsx)("span",{style:{marginLeft:15,display:["request","response","eventPayload","sofaContext","headers"].includes(y)&&a?"":"none"},children:(0,u.jsx)(n.A,{style:{visibility:a?"visibility":"hidden"},checked:(null===L||void 0===L?void 0:L.length)===(null===_||void 0===_?void 0:_.length),indeterminate:0<(null===_||void 0===_?void 0:_.length)&&(null===_||void 0===_?void 0:_.length)<(null===L||void 0===L?void 0:L.length),onChange:e=>F(e.target.checked),children:(0,u.jsx)("span",{children:"\u5168\u9009"})})})]});return{key:y,title:f,children:x?null:R(e,y,s+1)}};return Array.isArray(e)&&(null===e||void 0===e?void 0:e.length)>0?e.map(((e,l)=>{const t=l;return"object"===typeof e?i(e,t):i(e,t,!0)})):null!==e&&"object"===typeof e?Object.keys(e).map((l=>{const t=e[l];return i(t,l,!(null!==t&&"object"===typeof t))})):[{key:l,title:`${l}: ${e}`}]};return(0,u.jsx)("div",{style:{width:"100%",overflowX:"auto"},children:(0,u.jsx)(i.A,{treeData:R(b),onSelect:(e,l)=>{}})})},w={request:{eventPayload:{yamlData:{customerId:"2190170000031691",payToAmount:{cent:98998,currencyValue:"985",currency:"PLN"},extendInfo:{},unifiedBusinessLabel:"KA",consultServiceScenario:{skipRiskSecurity:!1,bizType:"TRADE",productCode:"MC400401000000000028",internalUser:!0,terminalType:"SYSTEM"},payFrom:{paymentIntentCurrency:"PLN"},paymentFactor:{skipPayFailedSendMsgProcess:!1,fundFlowMetadata:{}},paymentMethodTypes:["P24","P25"],partnerId:"2190170000031691"}}}},M=()=>{const[e,l]=(0,s.useState)(["assertChecked","editValue","isAllAssert","isAllCheckbox"]);return(0,u.jsx)("div",{children:(0,u.jsx)(I,{data:null===w||void 0===w?void 0:w.request,rootNode:"eventPayload",assertChecked:!0,editValue:!0,isAllAssert:!0,isAllCheckbox:!0,onChange:e=>{console.log("\ud83d\ude80 ~ DomainCase ~ vals:",e)}})})}}}]);
//# sourceMappingURL=724.30178f96.chunk.js.map