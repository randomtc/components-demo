"use strict";(self.webpackChunkcomponents_demo=self.webpackChunkcomponents_demo||[]).push([[724],{19724:(e,l,s)=>{s.r(l),s.d(l,{default:()=>V});var t=s(65043),n=s(30855),o=s(23513);const i=(e,l,s)=>{if(!e||!l||void 0===s)return;const t=JSON.parse(JSON.stringify(e)),n=l.split(".");let o=t;for(let i=0;i<n.length-1;i++){const e=isNaN(Number(n[i]))?n[i]:Number(n[i]);if(!o[e])throw new Error("Property not found: ".concat(n[i]));o=o[e]}return o[isNaN(Number(n[n.length-1]))?n[n.length-1]:Number(n[n.length-1])]=s,t};function r(e,l,s){try{const t=JSON.parse(JSON.stringify(e));return s.forEach(e=>{const s=t[l][e];"string"===typeof s&&(t[l][e]="null"===s?"null":"realYamlData"===e?s:(e=>{try{return JSON.parse(e),!0}catch(l){return!1}})(s)?JSON.parse(s):s)}),t}catch(t){return console.error("Failed to process fields:",t),e[l]||{}}}const a=e=>{try{const l=JSON.parse(JSON.stringify(e)),s=[],t=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Array.isArray(e)?e.forEach((e,n)=>{const o="".concat(l,".").concat(n);"object"===typeof e&&null!==e?t(e,o):s.push(o)}):null!==e&&"object"===typeof e&&Object.keys(e).forEach(n=>{const o=e[n],i=l?"".concat(l,".").concat(n):n;"object"===typeof o&&null!==o?t(o,i):s.push(i)})};return t(l),s}catch(l){console.error(l)}},d=e=>Array.isArray(e)?0===e.length?"[]":e.map(d):null!==e&&"object"===typeof e?Object.fromEntries(Object.entries(e).map(e=>{let[l,s]=e;return[l,d(s)]})):e,c=e=>e.map(e=>{const l=e.replace(/^[^\.]+/,"").replace(/\.(\d+)/g,"[$1]");return"$".concat(l)});var u=s(89379),v=s(53986),h=s(63343),p=s(25055),x=s(20273),y=s(72081),f=s(8354),A=s(47419),j=s(11645),m=s(43758),g=s(1118),S=s(15492),C=s(14524),E=s(61966),w=s(75337),T=s(70579);const b=["expressList"],k=["key","name"],{TextArea:N}=h.A,_={IS_NOT_EMPTY:"\u4e0d\u4e3a\u7a7a",IS_EMPTY:"\u4e3a\u7a7a",EQUALS:"==",NOT_EQUALS:"!=",IN:"IN",NOT_IN:"NOT_IN",GREATER_THAN:">",GREATER_THAN_OR_EQUAL_TO:">=",LESS_THAN:"<",LESS_THAN_OR_EQUAL_TO:"<="},L=e=>{const{keyPath:l,value:s,specialAssertConfigs:n=[],onConfirm:o}=e,[i]=p.A.useForm(),[r,a]=(0,t.useState)(!1),[d,c]=(0,t.useState)(),[L,O]=(0,t.useState)(null);(0,t.useEffect)(()=>{if(r){var e;const t=null===n||void 0===n?void 0:n.find(e=>(null===e||void 0===e?void 0:e.keyPath)===l);i.setFieldsValue({keyPath:l,value:s,expressList:null===t||void 0===t||!t.expressList||(null===t||void 0===t||null===(e=t.expressList)||void 0===e?void 0:e.length)<1?[{}]:null===t||void 0===t?void 0:t.expressList}),P()}},[r]);const P=()=>{const e=i.getFieldsValue();c(e);(e.expressList||[]).forEach((e,l)=>{null!==e&&void 0!==e&&e.expectValue||i.setFields([{name:["expressList",l,"parseFunction"],errors:[]}]),null!==e&&void 0!==e&&e.parseFunction||i.setFields([{name:["expressList",l,"expectValue"],errors:[]}])})};return(0,T.jsxs)("div",{style:{display:"inline-block"},onClick:e=>{e.stopPropagation()},children:[(0,T.jsx)(x.A,{title:"\u914d\u7f6e\u7279\u6b8a\u6821\u9a8c",children:(0,T.jsx)("a",{style:{cursor:"pointer"},onClick:e=>a(!0),children:(0,T.jsx)(C.A,{})})}),(0,T.jsx)(y.A,{title:"\u914d\u7f6e\u7279\u6b8a\u6821\u9a8c",width:650,style:{},open:r,onCancel:()=>a(!1),onOk:()=>{i.submit()},children:(0,T.jsxs)(p.A,{form:i,onFinish:e=>{const{expressList:l}=e,s=(0,v.A)(e,b),t=(0,u.A)((0,u.A)({},s),{},{expressList:null===l||void 0===l?void 0:l.filter(e=>["IS_NOT_EMPTY","IS_EMPTY"].includes(null===e||void 0===e?void 0:e.operator)?null===e||void 0===e?void 0:e.parseFunction:(null===e||void 0===e?void 0:e.parseFunction)&&(null===e||void 0===e?void 0:e.expectValue))});o(t),a(!1)},children:[(0,T.jsx)(p.A.Item,{label:"\u5b57\u6bb5\u8def\u5f84",name:"keyPath",children:(0,T.jsx)(h.A,{disabled:!0})}),(0,T.jsx)(p.A.Item,{label:"\u6570\u636e\u8be6\u60c5",name:"value",children:(0,T.jsx)(N,{placeholder:"\u8f93\u5165",disabled:!0})}),(0,T.jsx)(f.A,{}),(0,T.jsx)(p.A.List,{name:"expressList",children:(e,l)=>{let{add:s,remove:t}=l;return(0,T.jsxs)(T.Fragment,{children:[e.map(e=>{var l,s,n,o,i,r,a,c,x,y,S,C,w,b,I,M;let{key:Y,name:D}=e,F=(0,v.A)(e,k);return(0,T.jsxs)(A.A,{gutter:[8,6],children:[(0,T.jsx)(j.A,{span:24,children:(0,T.jsx)(p.A.Item,(0,u.A)((0,u.A)({},F),{},{label:"\u89e3\u6790\u51fd\u6570",name:[D,"parseFunction"],rules:[{required:!!["IS_NOT_EMPTY","IS_EMPTY"].includes(null===d||void 0===d||null===(l=d.expressList)||void 0===l||null===(s=l[D])||void 0===s?void 0:s.operator)||(null===d||void 0===d||null===(n=d.expressList)||void 0===n||null===(o=n[D])||void 0===o?void 0:o.expectValue),message:"\u8bf7\u8f93\u5165"}],required:!1,children:(0,T.jsx)(N,{rows:3,placeholder:"\u8f93\u5165",onChange:()=>{L&&clearTimeout(L);const e=setTimeout(()=>{P()},300);O(e)}})}))}),(0,T.jsx)(j.A,{span:8,children:(0,T.jsx)(p.A.Item,(0,u.A)((0,u.A)({},F),{},{label:"\u6821\u9a8c\u89c4\u5219",name:[D,"operator"],initialValue:"EQUALS",children:(0,T.jsx)(m.A,{onSelect:()=>{P()},showSearch:!0,dropdownStyle:{filter:"invert(0.85) hue-rotate(170deg)",boxShadow:"none"},placeholder:"\u8bf7\u9009\u62e9",options:Object.entries(_).map(e=>({value:e[0],label:e[1]}))})}))}),(0,T.jsx)(j.A,{span:15,children:(0,T.jsx)(p.A.Item,(0,u.A)((0,u.A)({},F),{},{name:[D,"expectValue"],rules:[{required:!["IS_NOT_EMPTY","IS_EMPTY"].includes(null===d||void 0===d||null===(i=d.expressList)||void 0===i||null===(r=i[D])||void 0===r?void 0:r.operator)&&(null===d||void 0===d||null===(a=d.expressList)||void 0===a||null===(c=a[D])||void 0===c?void 0:c.parseFunction),message:"\u8bf7\u8f93\u5165"}],children:["GREATER_THAN","GREATER_THAN_OR_EQUAL_TO","LESS_THAN","LESS_THAN_OR_EQUAL_TO"].includes(null===d||void 0===d||null===(x=d.expressList)||void 0===x||null===(y=x[D])||void 0===y?void 0:y.operator)?(0,T.jsx)(g.A,{style:{width:"100%"},placeholder:"\u8f93\u5165\uff08\u6570\u5b57\uff09",disabled:["IS_NOT_EMPTY","IS_EMPTY"].includes(null===d||void 0===d||null===(S=d.expressList)||void 0===S||null===(C=S[D])||void 0===C?void 0:C.operator),onChange:()=>{L&&clearTimeout(L);const e=setTimeout(()=>{P()},300);O(e)}}):(0,T.jsx)(h.A,{placeholder:["NOT_IN","IN"].includes(null===d||void 0===d||null===(w=d.expressList)||void 0===w||null===(b=w[D])||void 0===b?void 0:b.operator)?"\u591a\u4e2a\u503c\u8bf7\u7528\u82f1\u6587\u9017\u53f7\u5206\u9694":"\u8f93\u5165",disabled:["IS_NOT_EMPTY","IS_EMPTY"].includes(null===d||void 0===d||null===(I=d.expressList)||void 0===I||null===(M=I[D])||void 0===M?void 0:M.operator),onChange:()=>{L&&clearTimeout(L);const e=setTimeout(()=>{P()},300);O(e)}})}))}),(0,T.jsx)(j.A,{span:1,children:(0,T.jsx)(E.A,{style:{color:"red",marginTop:8,fontSize:16,cursor:"pointer"},onClick:()=>{t(D),P()}})}),(0,T.jsx)(f.A,{style:{marginTop:-10}})]},Y)}),(0,T.jsx)(p.A.Item,{children:(0,T.jsx)(S.Ay,{style:{width:"100%"},type:"dashed",onClick:()=>{s()},block:!0,icon:(0,T.jsx)(w.A,{}),children:"\u6dfb\u52a0\u89c4\u5219"})})]})}})]})})]})};var O=s(63390),P=s(53727),I=s(67407);const M=e=>{const{value:l,onEdit:s}=e,[n,o]=(0,t.useState)(l),[i,r]=(0,t.useState)(n),[a,d]=(0,t.useState)(!1),c=(0,t.useRef)(null),[u,v]=(0,t.useState)(0),[p,y]=(0,t.useState)(0),f=()=>{const e=c.current.offsetWidth,l=e/document.documentElement.clientWidth*100;v(e),y(l)};return(0,t.useEffect)(()=>{c.current&&f()},[c.current]),(0,T.jsx)("div",{style:{display:"inline-block"},children:(0,T.jsxs)("div",{style:{display:"flex"},children:[(0,T.jsx)("div",{children:a?(0,T.jsx)(h.A.TextArea,{rows:u>300?4:1,style:{width:u>300?"26vw":u+40,resize:"both"},value:i,onChange:e=>{r(e.target.value)}}):(0,T.jsx)("span",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:4,overflow:"hidden",textOverflow:"ellipsis",maxWidth:"24vw",lineHeight:"1.5",maxHeight:"6em"},ref:c,children:p>20?(0,T.jsx)(x.A,{placement:"topLeft",title:n,overlayStyle:{maxWidth:"30vw"},children:n}):n})}),(0,T.jsxs)("div",{style:{marginLeft:12,color:"#5478FC"},children:[a&&(0,T.jsxs)("div",{style:{display:"flex"},children:[(0,T.jsx)("div",{children:(0,T.jsx)(O.A,{onClick:()=>{o(i),s(i),d(!1)}})}),(0,T.jsx)("div",{style:{marginLeft:5},children:(0,T.jsx)(P.A,{onClick:()=>{d(!1)}})})]}),!a&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(I.A,{onClick:()=>{f(),d(!0)}})})]})]})})},Y=["yamlData","properties","sofaContext","eventPayload","headers","realYamlData"],D=e=>{const{data:l,rootNode:s,showAssertChecked:u=!1,showEditValue:v=!1,isAllAssert:h=!1,isAllCheckbox:p=!1,onChange:x,interfaceObj:y,showNode:f,noShowAssert:A,showConfigSpecialVerif:j=!1,selectKey:m,selectKeyRootNode:g}=e,[S,C]=(0,t.useState)(r(l,s,Y)),[E,w]=(0,t.useState)(),[b,k]=(0,t.useState)([]),[N,_]=(0,t.useState)([]);(0,t.useEffect)(()=>{x(S)},[S]);const[O,P]=(0,t.useState)(!0);(0,t.useEffect)(()=>{if(l){var e,t,n,o,i,c;const v=r(l,s,Y);var u;if(O)k(((e,l,s)=>e?e.map(e=>{let t=e.replace(/^\$/,"");return t=t.replace(/\[(\d+)\]/g,".$1"),t.startsWith(".")&&(t=t.slice(1)),"".concat(null!==l&&void 0!==l?l:s,".").concat(t)}):[])(null===(u=v[s])||void 0===u?void 0:u[m||"assertKeys"],g,s));v.rootNode=v;const h=null===v||void 0===v||null===(e=v[s])||void 0===e?void 0:e.yamlData,p=null===v||void 0===v||null===(t=v[s])||void 0===t?void 0:t.properties,x=null===v||void 0===v||null===(n=v[s])||void 0===n?void 0:n.sofaContext,A=null===v||void 0===v||null===(o=v[s])||void 0===o?void 0:o.eventPayload,j=null===v||void 0===v||null===(i=v[s])||void 0===i?void 0:i.headers,S=null===v||void 0===v||null===(c=v[s])||void 0===c?void 0:c.realYamlData,C={yamlData:h,properties:p,sofaContext:x,eventPayload:A},E={yamlData:h,sofaContext:x},T={yamlData:h,headers:j},b={[f]:C[f]},N={[f]:E[f]},L={[f]:T[f]},I=()=>{const e={[s]:h||{}};let l=e;return"realYamlData"===f&&(l={[s]:S||{}}),"MSG"===y&&(l=b),"RPC"===y&&(l=f?N:e),"HTTP"===y&&(l=f?L:e),l};w(d(I())),O&&_(a(d(I()))),P(!1)}},[l]);const I=(e,l,s)=>{const t=l.split(".")||[];"MSG"===y&&"assertKeys"!==t[1]&&("realYamlData"===f?t.splice(1,0,"realYamlData"):t.unshift("request")),"MSG"!==y&&"assertKeys"!==t[1]&&(f?"realYamlData"===f?t.splice(1,0,"realYamlData"):t.unshift("request"):t.splice(1,0,"yamlData"));const n=null===t||void 0===t?void 0:t.join("."),o=i(e,n,s);C(o)},D=e=>{if(e){const e=a(E);k(e)}else k([])},[F,V]=(0,t.useState)(!0);(0,t.useEffect)(()=>{[F,p,E,0===(null===b||void 0===b?void 0:b.length)].every(e=>e)&&(D(!0),V(!1))},[s,E]),(0,t.useEffect)(()=>{var e;u&&((e=b).length>0?I(S,"".concat(s,".assertKeys"),c(e)):I(S,"".concat(s,".assertKeys"),[]))},[b]);const R=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"root",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=function(e,o){var r,a,d;let p=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const x=0===t?"".concat(o):"".concat(l,".").concat(o),y=p?(0,T.jsxs)("div",{style:{display:"flex"},children:[(0,T.jsxs)("span",{children:[o,"\uff1a"]}),(0,T.jsx)("span",{children:v?(0,T.jsx)(M,{value:String(e),onEdit:e=>((e,l)=>{I(S,e,l)})(x,e)}):String(e)}),(0,T.jsx)("span",{style:{display:j?"":"none",marginLeft:5},children:(0,T.jsx)(L,{keyPath:null===(r=c([x]))||void 0===r?void 0:r[0],value:String(e),specialAssertConfigs:null!==(a=null===S||void 0===S||null===(d=S[s])||void 0===d?void 0:d.specialAssertConfigs)&&void 0!==a?a:[],onConfirm:e=>{(e=>{var l,t;const n=null!==(l=null===S||void 0===S||null===(t=S[s])||void 0===t?void 0:t.specialAssertConfigs)&&void 0!==l?l:[],o=new Map;[...n,e].forEach(e=>{o.set(e.keyPath,e)});const r=Array.from(o.values()),a=i(S,"".concat(s,".specialAssertConfigs"),r);C(a)})(e)}})}),(0,T.jsx)("span",{style:{marginLeft:5,display:u?"":"none"},children:(0,T.jsx)(n.A,{checked:null===b||void 0===b?void 0:b.includes(x),onChange:e=>{((e,l)=>{let s=[...b];e?s.push(l):s=s.filter(e=>e!==l),k(s)})(e.target.checked,x)},children:(0,T.jsx)("span",{style:{color:"red"},children:A?"":"Assert"})})})]}):(0,T.jsxs)("div",{children:[(0,T.jsx)("span",{children:o}),(0,T.jsx)("span",{style:{marginLeft:15,display:["request","response","eventPayload","sofaContext","headers"].includes(x)&&h&&u?"":"none"},children:(0,T.jsx)(n.A,{style:{visibility:h?"visibility":"hidden"},checked:(null===N||void 0===N?void 0:N.length)===(null===b||void 0===b?void 0:b.length),indeterminate:0<(null===b||void 0===b?void 0:b.length)&&(null===b||void 0===b?void 0:b.length)<(null===N||void 0===N?void 0:N.length),onChange:e=>D(e.target.checked),children:(0,T.jsx)("span",{children:"\u5168\u9009"})})})]});return{key:x,title:y,children:p?null:R(e,x,t+1)}};return Array.isArray(e)&&(null===e||void 0===e?void 0:e.length)>0?e.map((e,l)=>{const s=l;return"object"===typeof e?o(e,s):o(e,s,!0)}):null!==e&&"object"===typeof e?Object.keys(e).map(l=>{const s=e[l];return o(s,l,!(null!==s&&"object"===typeof s))}):[{key:l,title:"".concat(l,": ").concat(e)}]};return(0,T.jsx)("div",{style:{width:"100%",overflowX:"auto"},children:E&&(0,T.jsx)(o.A,{defaultExpandedKeys:N,treeData:R(E),onSelect:(e,l)=>{}})})},F={request:{eventPayload:{yamlData:{id:"2190170000031691",paymentFactor:{productCode:"MC400401000000000028",internalUser:!0,skipPayFailedSendMsgProcess:!1,fundFlowMetadata:{}},paymentMethodTypes:["P24","P25",{bizType:"TRADE",productCode:"MC400401000000000028",internalUser:!0}]}}}},V=()=>{var e,l,s,o;const[i,r]=(0,t.useState)(["showAssertChecked","showEditValue","showConfigSpecialVerif"]),[a,d]=(0,t.useState)(null===F||void 0===F?void 0:F.request);return(0,T.jsx)("div",{style:{padding:15},children:(0,T.jsxs)("div",{style:{display:"flex",fontSize:12,gap:24},children:[(0,T.jsxs)("div",{style:{width:500},children:[(0,T.jsx)("h3",{children:"\u6570\u636e\u6e90"}),(0,T.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",backgroundColor:"#f5f5f5"},children:(0,T.jsx)("code",{children:JSON.stringify(null===a||void 0===a||null===(e=a.eventPayload)||void 0===e?void 0:e.yamlData,null,2)})}),(0,T.jsx)("h3",{children:"\u9009\u62e9\u8282\u70b9"}),(0,T.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",backgroundColor:"#f5f5f5"},children:(0,T.jsx)("code",{children:JSON.stringify(null!==(l=null===a||void 0===a||null===(s=a.eventPayload)||void 0===s?void 0:s.assertKeys)&&void 0!==l?l:"{}",null,2)})}),(0,T.jsx)("h3",{children:"\u6821\u9a8c\u89c4\u5219"}),(0,T.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",backgroundColor:"#f5f5f5"},children:(0,T.jsx)("code",{children:JSON.stringify(null===a||void 0===a||null===(o=a.eventPayload)||void 0===o?void 0:o.specialAssertConfigs,null,2)})})]}),(0,T.jsxs)("div",{children:[(0,T.jsx)("div",{style:{marginBottom:20},children:(0,T.jsx)(n.A.Group,{options:[{label:"Assert",value:"showAssertChecked"},{label:"\u7f16\u8f91",value:"showEditValue"},{label:"\u914d\u7f6e",value:"showConfigSpecialVerif"}],value:i,onChange:e=>{r(e)}})}),(0,T.jsx)(D,{data:null===F||void 0===F?void 0:F.request,rootNode:"eventPayload",showAssertChecked:i.includes("showAssertChecked"),showEditValue:i.includes("showEditValue"),showConfigSpecialVerif:i.includes("showConfigSpecialVerif"),isAllAssert:!0,isAllCheckbox:!0,onChange:e=>{console.log("\ud83d\ude80 ~ DomainCase ~ vals:",e),d(e)}})]})]})})}}}]);
//# sourceMappingURL=724.66a555a4.chunk.js.map